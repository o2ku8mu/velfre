<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ベルティと風のふもとの仲間たち | Fujinohara World</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'fuji-base': '#fdfbf7',
                        'fuji-text': '#4a4a4a',
                        'fuji-accent': '#7189bf',
                        'fuji-warm': '#e09f7d',
                        'fuji-green': '#a8c69f',
                    },
                    fontFamily: {
                        sans: ['"Zen Maru Gothic"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #fdfbf7;
            color: #4a4a4a;
            font-family: 'Zen Maru Gothic', sans-serif;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #aaa; }

        .fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-overlay {
            background-color: rgba(74, 74, 74, 0.4);
            backdrop-filter: blur(4px);
        }

        /* BIG FIVE Bar Chart Styles */
        .bigfive-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.8rem;
        }
        .bigfive-label {
            width: 90px;
            font-weight: bold;
            color: #666;
            text-align: right;
            padding-right: 10px;
            font-size: 0.75rem;
        }
        .bigfive-bar-container {
            flex-grow: 1;
            height: 24px;
            background-color: #f0f0f0;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        .bigfive-center-line {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 2px;
            background-color: #ccc;
            z-index: 10;
        }
        .bigfive-bar {
            height: 100%;
            position: absolute;
            top: 0;
            border-radius: 4px;
            transition: width 0.6s ease-out;
            opacity: 0.8;
        }
        .bigfive-value {
            position: absolute;
            font-size: 0.7rem;
            font-weight: bold;
            color: #fff;
            top: 50%;
            transform: translateY(-50%);
            padding: 0 6px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
            z-index: 20;
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- Header -->
    <header class="w-full py-6 px-4 md:px-8 flex justify-between items-center bg-white/50 sticky top-0 z-30 shadow-sm backdrop-blur-sm">
        <div class="flex items-center gap-3">
            <div class="text-3xl text-fuji-accent"><i class="fa-solid fa-wind"></i></div>
            <h1 class="text-xl md:text-2xl font-bold tracking-wide text-fuji-text">フジノハラ <span class="text-sm font-normal ml-2 hidden sm:inline-block">ベルティと風のふもとの仲間たち</span></h1>
        </div>
        <button onclick="scrollToId('characters')" class="bg-fuji-warm text-white px-5 py-2 rounded-full text-sm hover:bg-opacity-90 transition shadow-md">
            仲間に出会う
        </button>
    </header>

    <!-- Hero Section -->
    <section class="relative w-full py-24 px-6 text-center overflow-hidden">
        <div class="absolute inset-0 z-0 opacity-10 pointer-events-none">
            <div class="absolute top-10 left-10 text-9xl text-fuji-accent"><i class="fa-solid fa-cloud"></i></div>
            <div class="absolute bottom-10 right-10 text-9xl text-fuji-warm"><i class="fa-solid fa-mountain"></i></div>
        </div>
        
        <div class="relative z-10 max-w-4xl mx-auto space-y-8 fade-in">
            <p class="text-fuji-accent font-medium tracking-widest text-lg">“ちがい”が風を起こす物語</p>
            <h2 class="text-4xl md:text-6xl font-bold !leading-[1.4] text-fuji-text">
                あなたの「弱さ」は、<br>誰かの「救い」になる。
            </h2>
            <p class="text-lg md:text-xl text-gray-600 leading-relaxed pt-2">
                富士山のふもと、目には見えない風の国「フジノハラ」。<br>
                そこには、私たちの心が生み出す「感情の風」を循環させる<br>
                12人の精霊たちが暮らしています。
            </p>
        </div>
    </section>

    <!-- Worldview Section -->
    <section id="world" class="w-full py-16 px-4 bg-white">
        <div class="max-w-5xl mx-auto">
            <div class="text-center mb-12">
                <h3 class="text-2xl font-bold text-fuji-text mb-2"><i class="fa-solid fa-earth-asia mr-2 text-fuji-green"></i>ふもとの国「フジノハラ」</h3>
                <p class="text-gray-500">懐かしくて奇妙な、風の生まれる場所</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-fuji-base p-6 rounded-2xl shadow-sm hover:shadow-md transition duration-300 border border-gray-100">
                    <div class="text-4xl text-fuji-green mb-4"><i class="fa-solid fa-tree"></i></div>
                    <h4 class="text-lg font-bold mb-3">忘れ物の森</h4>
                    <p class="text-sm leading-relaxed text-gray-600">
                        苔むした巨大なポスト、湖に沈む観覧車。人間界で強い感情とともに手放されたモノたちが、自然と融合して風景になっています。
                    </p>
                </div>
                <div class="bg-fuji-base p-6 rounded-2xl shadow-sm hover:shadow-md transition duration-300 border border-gray-100">
                    <div class="text-4xl text-fuji-accent mb-4"><i class="fa-solid fa-utensils"></i></div>
                    <h4 class="text-lg font-bold mb-3">空気を食べる</h4>
                    <p class="text-sm leading-relaxed text-gray-600">
                        ベルフレたちの食事は「その場の空気」。ピリピリした空気は辛く、リラックスした空気は甘い。良い雰囲気を作ることは生きるために不可欠です。
                    </p>
                </div>
                <div class="bg-fuji-base p-6 rounded-2xl shadow-sm hover:shadow-md transition duration-300 border border-gray-100">
                    <div class="text-4xl text-gray-400 mb-4"><i class="fa-solid fa-ghost"></i></div>
                    <h4 class="text-lg font-bold mb-3">ナリカリと澱（おり）</h4>
                    <p class="text-sm leading-relaxed text-gray-600">
                        感情を押し殺した時に生まれる黒い「澱」。それに飲み込まれた人間の成れの果てが「ナリカリ」。彼らの「異常な普通さ」が風を止めます。
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- Characters Section -->
    <section id="characters" class="w-full py-16 px-4 bg-fuji-base">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-10">
                <h3 class="text-3xl font-bold text-fuji-text mb-4">12人のベルフレ（ゆーま族）</h3>
                <p class="text-gray-600 max-w-2xl mx-auto mb-6">
                    彼らはあなたの心の化身。完璧じゃないけれど、愛おしい。<br>
                    気になるキャラクターを選んで、心の形を覗いてみましょう。
                </p>
                
                <div class="flex flex-wrap justify-center gap-2 mb-8">
                    <button onclick="filterCharacters('all')" class="filter-btn active px-4 py-2 rounded-full text-sm font-medium bg-gray-200 hover:bg-fuji-accent hover:text-white transition" data-filter="all">全員</button>
                    <button onclick="filterCharacters('leader')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-gray-200 hover:bg-fuji-accent hover:text-white transition" data-filter="leader">引っ張るタイプ</button>
                    <button onclick="filterCharacters('support')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-gray-200 hover:bg-fuji-accent hover:text-white transition" data-filter="support">支えるタイプ</button>
                    <button onclick="filterCharacters('unique')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-gray-200 hover:bg-fuji-accent hover:text-white transition" data-filter="unique">我が道を行くタイプ</button>
                    <button onclick="filterCharacters('sensitive')" class="filter-btn px-4 py-2 rounded-full text-sm font-medium bg-gray-200 hover:bg-fuji-accent hover:text-white transition" data-filter="sensitive">繊細・慎重タイプ</button>
                </div>
            </div>

            <div id="character-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Javascript fills this -->
            </div>
        </div>
    </section>

    <!-- Footer Note -->
    <footer class="bg-gray-800 text-white py-6 text-center text-xs">
        <p class="mb-2">&copy; 2025 Fujinohara Project.</p>
        <p class="text-gray-400">
            <i class="fa-solid fa-circle-info mr-1"></i> 画像が表示されない場合：<br>
            このHTMLファイルと画像ファイル（.png）を同じフォルダに保存してください。
        </p>
    </footer>

    <!-- Character Detail Modal -->
    <div id="char-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 modal-overlay" onclick="closeModal()"></div>
        <div class="absolute inset-0 flex items-center justify-center p-4 pointer-events-none">
            <div class="bg-white rounded-3xl shadow-2xl w-full max-w-6xl h-[90vh] overflow-hidden pointer-events-auto flex flex-col md:flex-row relative">
                
                <button onclick="closeModal()" class="absolute top-4 right-4 z-10 w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition shadow">
                    <i class="fa-solid fa-xmark text-gray-600"></i>
                </button>

                <!-- Left Column: Visuals & Stats -->
                <div class="w-full md:w-5/12 bg-fuji-base p-6 md:p-8 flex flex-col overflow-y-auto border-r border-gray-100">
                    
                    <div class="text-center mb-6">
                        <div id="modal-icon-container" class="mb-4 inline-block relative w-32 h-32 mx-auto">
                            <!-- JS injects Image here with fallback to Icon -->
                        </div>
                        <h2 id="modal-name" class="text-3xl font-bold text-fuji-text mb-1"></h2>
                        <p id="modal-role" class="text-sm text-white bg-fuji-accent px-3 py-1 rounded-full shadow-sm inline-block mb-1"></p>
                    </div>

                    <!-- BIG FIVE BAR CHART -->
                    <div class="bg-white p-5 rounded-2xl shadow-sm mb-6 border border-gray-100">
                        <div class="flex justify-between text-xs text-gray-400 font-bold mb-2 px-2">
                            <span>LOW (-50)</span>
                            <span>BIG FIVE</span>
                            <span>HIGH (+50)</span>
                        </div>
                        <div id="bigfive-chart-container">
                            <!-- JS Generates Bars Here -->
                        </div>
                    </div>

                    <!-- Vibe / Ecology -->
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                         <div class="flex items-center gap-2 mb-2">
                            <i class="fa-solid fa-leaf text-fuji-green"></i>
                            <h4 class="font-bold text-gray-700 text-sm">生態</h4>
                        </div>
                        <p id="modal-vibe" class="text-gray-600 text-sm leading-relaxed"></p>
                    </div>
                </div>

                <!-- Right Column: Text Content -->
                <div class="w-full md:w-7/12 p-6 md:p-10 overflow-y-auto bg-white">
                    <div class="space-y-8">
                        <!-- Catchphrase -->
                        <h3 id="modal-catch" class="text-xl md:text-2xl font-bold text-fuji-warm leading-snug"></h3>

                        <!-- Story Section -->
                        <div>
                            <div class="flex items-center gap-2 mb-3">
                                <i class="fa-solid fa-book-open text-fuji-accent"></i>
                                <h4 class="font-bold text-gray-700">過去と転機</h4>
                            </div>
                            <p id="modal-past" class="text-gray-600 text-sm leading-loose bg-gray-50 p-5 rounded-xl border border-gray-100"></p>
                        </div>

                        <!-- Mind Section -->
                        <div class="grid grid-cols-1 gap-4">
                            <div class="flex gap-4">
                                <div class="w-1/2">
                                    <div class="flex items-center gap-2 mb-2">
                                        <i class="fa-solid fa-star text-fuji-warm"></i>
                                        <h4 class="font-bold text-gray-700 text-sm">ポリシー</h4>
                                    </div>
                                    <p id="modal-policy" class="text-gray-600 text-xs leading-relaxed"></p>
                                </div>
                                <div class="w-1/2">
                                    <div class="flex items-center gap-2 mb-2">
                                        <i class="fa-solid fa-heart text-fuji-warm"></i>
                                        <h4 class="font-bold text-gray-700 text-sm">動機</h4>
                                    </div>
                                    <p id="modal-motivation" class="text-gray-600 text-xs leading-relaxed"></p>
                                </div>
                            </div>
                        </div>

                        <!-- Buddy Section -->
                        <div class="border-t border-gray-100 pt-6">
                            <div class="flex items-center gap-2 mb-4">
                                <i class="fa-solid fa-handshake-simple text-fuji-accent"></i>
                                <h4 class="font-bold text-gray-700">補い合う相棒</h4>
                            </div>
                            <div id="modal-buddies-container" class="grid grid-cols-1 gap-3">
                                <!-- JS Populates 2 Buddies Here -->
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Logic -->
    <script>
        const characters = [
            {
                id: 1, name: "ドラティ", animal: "ドラゴン", role: "市長", icon: "fa-dragon", image: "drati.png", type: "leader", color: "text-red-500",
                stats: { N: 41, E: 39, O: 39, A: 29, C: 39 },
                catchphrase: "完璧に見えて、実はプレッシャーと戦う優等生",
                past: "幼い頃から「優等生」だったが、無理をして倒れた時にみんなが楽しそうにしているのを見て「自分は不要？」と孤独を感じた。復帰後、弱さを見せて頼ることで「完璧より信頼」が大切だと気づいた。",
                policy: "「“完璧”を目指すより、“最善”をみんなで選ぶ」",
                motivation: "一人ひとりが主役の街を作りたい。",
                vibe: "テッペン雲の上。翼があるのに飛ぶのが怖くて徒歩移動。",
                buddies: [
                    { id: 11, desc: "常に高みを目指す自分とは正反対のパダティ。でも、彼の笹をもらう時だけは肩書きを捨ててリラックスできる。" },
                    { id: 6, desc: "ドラティの掲げる大きな理想を、キリティが実務的な計画に落とし込んでくれる最高のビジネスパートナー。" }
                ]
            },
            {
                id: 2, name: "ガオティ", animal: "ライオン", role: "アイドル", icon: "fa-sun", image: "gaoti.png", type: "sensitive", color: "text-orange-500",
                stats: { N: -18, E: 27, O: 22, A: 30, C: 37 },
                catchphrase: "強がりだけど、夜は枕を濡らす繊細なパフォーマー",
                past: "ネットの心ない言葉に傷つき引きこもった過去がある。しかしファンレターで「その涙に救われた」と言われ、自分の傷つきやすさは共感力という才能だと知った。",
                policy: "「涙の数だけ、優しさは強くなる」",
                motivation: "「泣いてもいいんだよ」と伝えられるステージを届けたい。",
                vibe: "ひだまり広場。落ち込むとタテガミがしぼんでただの猫になる。",
                buddies: [
                    { id: 8, desc: "楽屋裏の弱い姿を見せられる数少ない相手。言葉なくそばにいてくれるシロティに充電させてもらっている。" },
                    { id: 7, desc: "自分のファンであり、守ってくれる存在。トゲトゲの裏にある照れや愛情に、繊細なガオティだけが気づいている。" }
                ]
            },
            {
                id: 3, name: "ワンティ", animal: "ゴールデンレトリバー", role: "郵便配達員", icon: "fa-dog", image: "wanti.png", type: "unique", color: "text-yellow-500",
                stats: { N: 39, E: 37, O: -12, A: 8, C: -1 },
                catchphrase: "根拠のない自信で、みんなの心を軽くする楽天家",
                past: "誤配の大失敗をしたが、その先で老人を救ってしまった。「計画通りにいかないことが幸運を運ぶこともある」と開き直り、前進することを選んだ。",
                policy: "「寄り道こそが、本当の近道」",
                motivation: "計画通りにいかない人生を楽しむ姿を見せたい。",
                vibe: "カケッコ草原。配達員なのに地図が読めず、野生の勘で動く。",
                buddies: [
                    { id: 4, desc: "ビバティは天敵だが、彼が責任感で潰れそうな時は無理やり散歩に連れ出す。「仕事より命！」という明るさが救い。" },
                    { id: 1, desc: "ドラティの完璧な指示を聞き流すが、その適当さがドラティの緊張を解く鍵になっている。" }
                ]
            },
            {
                id: 4, name: "ビバティ", animal: "ビーバー", role: "大工（現場監督）", icon: "fa-hammer", image: "bivati.png", type: "support", color: "text-brown-500",
                stats: { N: 31, E: -16, O: 13, A: 10, C: 34 },
                catchphrase: "頼まれたら断れない、限界突破のハードワーカー",
                past: "断れずに仕事を抱え込み倒れ、逆に迷惑をかけた。「自分もメンテが必要なインフラの一部」と気づき、休む勇気を学んだ。",
                policy: "「良い仕事は、健やかな心と体から」",
                motivation: "無理している人に「帰ろう」と言える社会基盤を作りたい。",
                vibe: "セキトメ川のダム。立派なダムを作るが、自分の家はボロボロ。",
                buddies: [
                    { id: 3, desc: "「また荷物届いてないよ！」と怒りつつ、彼の明るさに救われている。自分にはない「楽観性」を補ってもらう。" },
                    { id: 11, desc: "「休むのも仕事」と諭してくれる師匠。パダティの宿で強制的に休まされるのがエネルギー源。" }
                ]
            },
            {
                id: 5, name: "オムティ", animal: "オウム", role: "記者兼バイヤー", icon: "fa-crow", image: "omuti.png", type: "unique", color: "text-green-500",
                stats: { N: -10, E: 36, O: 35, A: 22, C: -25 },
                catchphrase: "あっちこっち興味津々、器用貧乏なトレンドセッター",
                past: "何をやっても中途半端だったが、無関係な知識を組み合わせたアイデアを絶賛され、「広く浅い知識」は点と点を繋ぐ武器だと自信を持った。",
                policy: "「飽きることは、次の扉を開けた証拠」",
                motivation: "バラバラなものを繋ぎ合わせ、新しい価値を生みたい。",
                vibe: "サワガシの森。記者なのにメモを取らず、熱量だけで喋る。",
                buddies: [
                    { id: 9, desc: "記事を論破されるが、めげずにネタを持ち込む。堅い頭を柔らかくし、逆にアイデアを形にしてもらう関係。" },
                    { id: 8, desc: "オムティが集めた雑多な本や資料を、シロティがアーカイブしてくれる。動のオムティと静のシロティ。" }
                ]
            },
            {
                id: 6, name: "キリティ", animal: "キリン", role: "コンサルタント", icon: "fa-binoculars", image: "kiriti.png", type: "leader", color: "text-yellow-600",
                stats: { N: -28, E: -26, O: 35, A: 14, C: -22 },
                catchphrase: "先読みしすぎて動けない、頭でっかちな哲学者",
                past: "心配しすぎて遠足を中止させたら晴天になり非難された。しかし嵐の予兆に気づき街を救ったことで、臆病さは「高感度センサー」だと認めた。",
                policy: "「100の心配事は、1つの悲劇を防ぐ盾になる」",
                motivation: "最悪の未来を予測し、最高の回避ルートを提案したい。",
                vibe: "ミワタシ台地。未来を見すぎて、現在の足元がお留守。",
                buddies: [
                    { id: 10, desc: "天敵だが、動けない時に物理的に背中を蹴飛ばしてくれる唯一の存在。アクセルとブレーキの最強コンビ。" },
                    { id: 1, desc: "ドラティの理想を実現可能な計画に変換する参謀役。ドラティが太陽なら、キリティはそれを支える大地。" }
                ]
            },
            {
                id: 7, name: "ハリティ", animal: "ハリネズミ", role: "警備員", icon: "fa-shield-heart", image: "hariti.png", type: "sensitive", color: "text-gray-500",
                stats: { N: -24, E: 25, O: -25, A: 8, C: -26 },
                catchphrase: "傷つきたくないからトゲを出す、本当は甘えん坊なツンデレ",
                past: "裏切られた過去から心を閉ざしていたが、何度拒絶しても笑ってくれるガオティを見て、トゲがあっても愛されると知った。",
                policy: "「私の扉は重いけど、中は誰より暖かい」",
                motivation: "一度心を許した仲間は命がけで守り抜く。",
                vibe: "バラの茂み。警備員なのに人が来ると隠れてモニター越しに見る。",
                buddies: [
                    { id: 2, desc: "密かな推し。ガオティを守るためなら体を張る。眩しくて直視できない。" },
                    { id: 12, desc: "お互いに干渉しない距離感が心地よく、無言で一緒にお茶を飲む仲。言葉がいらない関係。" }
                ]
            },
            {
                id: 8, name: "シロティ", animal: "シロクマ", role: "図書館司書", icon: "fa-book", image: "siroti.png", type: "support", color: "text-blue-300",
                stats: { N: -23, E: -30, O: -15, A: 11, C: 26 },
                catchphrase: "殻にこもって黙々と。信頼度No.1の静かなる守護者",
                past: "集団行動ができず悩んでいたが、孤独な作業で驚異的な集中力を発揮し、「孤独こそが才能を最大化する」と確信した。",
                policy: "「静けさは、言葉よりも多くを語る」",
                motivation: "見過ごされがちな真実や小さな声を静かに守りたい。",
                vibe: "コオリの洞窟。極寒なのに常に温かいお茶を入れている。",
                buddies: [
                    { id: 5, desc: "騒がしいオムティは苦手だが、彼の持ってくる本には興味津々。閉じた世界に窓を開けてくれる存在。" },
                    { id: 2, desc: "ガオティが疲れ果てて図書館の隅で寝ていると、黙って毛布をかけてあげるような、静かな信頼関係。" }
                ]
            },
            {
                id: 9, name: "コンティ", animal: "キツネ", role: "裁判官", icon: "fa-scale-balanced", image: "konti.png", type: "leader", color: "text-purple-600",
                stats: { N: 27, E: -26, O: -25, A: -14, C: -15 },
                catchphrase: "群れずに我が道を行く、クールなリアリスト",
                past: "正論を言って孤立したが、パニック時に冷静な指示で事態を収拾。「嫌われ役を買ってでも事実を見る力」が皆を守ると気づいた。",
                policy: "「感情は熱く、思考は冷たく」",
                motivation: "忖度や同調圧力のないクリアな世界を維持したい。",
                vibe: "ツキアカリ湖畔。裁判官だが足元は裸足（地に足をつけるため）。",
                buddies: [
                    { id: 5, desc: "適当な発言を許せず「ソースは？」と詰め寄るが、オムティの柔軟な発想には一目置いており、思考をほぐしてもらう。" },
                    { id: 12, desc: "独自の美学を持つ者同士。論理的な自分と直感的なキャッティは、方法は違うが個を貫く同志。" }
                ]
            },
            {
                id: 10, name: "シャッティ", animal: "シャチ", role: "レスキュー隊員", icon: "fa-water", image: "shati.png", type: "leader", color: "text-blue-700",
                stats: { N: 14, E: 9, O: 9, A: -41, C: 6 },
                catchphrase: "忖度なしの正論パンチ！迷いを断ち切る切り込み隊長",
                past: "協調性がないと左遷されたが、同調圧力をぶち壊して皆の目を覚まさせた時、「空気を読まないのではなく変える力」だと自覚した。",
                policy: "「波風を立てない海に、船は進まない」",
                motivation: "停滞を打破し、先陣を切って戦いたい。",
                vibe: "アラナミの海。海の生き物なのに陸でも平気で活動する。",
                buddies: [
                    { id: 6, desc: "「考えすぎだ！」と背中を蹴飛ばす相手。キリティが動けない時は必ず助けに行く。アクセルとブレーキ。" },
                    { id: 9, desc: "論理で攻めるコンティと、直感で攻めるシャッティ。「嘘を許さない」点は共通しており、背中を預け合える。" }
                ]
            },
            {
                id: 11, name: "パダティ", animal: "パンダ", role: "スパの主人", icon: "fa-spa", image: "padati.png", type: "unique", color: "text-gray-700",
                stats: { N: -34, E: -36, O: -33, A: 6, C: -33 },
                catchphrase: "“あるがまま”の達人。競争社会から降りた自由人",
                past: "競争社会で燃え尽き、竹林に逃げた。「何もしない」姿が癒やしになると言われ、競争から降りることで価値を見出した。",
                policy: "「生きているだけで、丸儲け」",
                motivation: "最高の「手抜き」と「休息」を提供したい。",
                vibe: "ノンビリ竹林。客が来ても寝ていて、勝手に休んでいくシステム。",
                buddies: [
                    { id: 4, desc: "常に忙しそうなビバティを見ると放っておけず、「お茶でも飲んでいきなよ」と引き留める。精神安定剤。" },
                    { id: 1, desc: "ドラティが唯一、市長という肩書きを捨てて甘えられる場所を提供している。" }
                ]
            },
            {
                id: 12, name: "キャッティ", animal: "ねこ", role: "探偵兼芸術家", icon: "fa-cat", image: "cati.png", type: "unique", color: "text-indigo-500",
                stats: { N: -21, E: -27, O: -34, A: -46, C: -33 },
                catchphrase: "理解されなくてもいい。孤高を愛するミステリアス・アーティスト",
                past: "「宇宙人」扱いされ孤独だったが、常識外のひらめきで難事件を解決。「みんなと違う」ことは「鍵」を持っていることだと知った。",
                policy: "「道がないなら、屋根を歩けばいい」",
                motivation: "隙間の真実を見つけ、世界に風穴を開けたい。",
                vibe: "マヨイの路地裏。依頼を受けず、気になった謎だけ勝手に解く。",
                buddies: [
                    { id: 7, desc: "お互いに「一人が好き」なもの同士。近づきすぎず、遠くから存在を確認し合うような距離感が心地よい。" },
                    { id: 9, desc: "キャッティの突飛な行動を、コンティだけが「なるほど、そういう理屈か」と面白がって分析してくれる理解者。" }
                ]
            }
        ];

        // Functions
        function renderGrid(filterType = 'all') {
            const grid = document.getElementById('character-grid');
            grid.innerHTML = '';
            const filtered = filterType === 'all' ? characters : characters.filter(c => c.type === filterType);

            filtered.forEach(char => {
                const card = document.createElement('div');
                card.className = "bg-white rounded-2xl p-6 shadow-sm hover:shadow-lg transition cursor-pointer border border-gray-100 flex flex-col items-center text-center group h-full";
                card.onclick = () => openModal(char.id);

                // Robust Image Fallback logic for Grid
                const iconHtml = `
                    <div class="relative w-full h-full flex justify-center items-center">
                        <img 
                            src="${char.image}" 
                            alt="${char.name}" 
                            class="w-full h-full object-cover group-hover:scale-105 transition duration-500 absolute inset-0 z-10"
                            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                        >
                        <i class="fa-solid ${char.icon} text-4xl ${char.color} group-hover:scale-110 transition duration-300 hidden"></i>
                    </div>
                `;

                // Logic for non-image fallbacks if needed, but here we always try image first if present
                
                card.innerHTML = `
                    <div class="w-24 h-24 rounded-full bg-fuji-base flex items-center justify-center mb-4 overflow-hidden border-2 border-transparent group-hover:border-fuji-accent/30 transition duration-300 relative">
                        ${iconHtml}
                    </div>
                    <div class="text-xs font-bold text-gray-400 mb-1 uppercase tracking-wider">${char.role}</div>
                    <h4 class="text-xl font-bold text-fuji-text mb-2">${char.name}</h4>
                    <p class="text-xs text-gray-500 line-clamp-2">${char.catchphrase}</p>
                    <div class="mt-auto pt-4 text-fuji-accent text-sm font-medium opacity-0 group-hover:opacity-100 transition">
                        詳細を見る <i class="fa-solid fa-arrow-right ml-1"></i>
                    </div>
                `;
                grid.appendChild(card);
            });
            
            // Filter Buttons Logic
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if(btn.dataset.filter === filterType) {
                    btn.classList.add('bg-fuji-accent', 'text-white');
                    btn.classList.remove('bg-gray-200');
                } else {
                    btn.classList.remove('bg-fuji-accent', 'text-white');
                    btn.classList.add('bg-gray-200');
                }
            });
        }

        function renderBigFiveChart(stats, colorClass) {
            const container = document.getElementById('bigfive-chart-container');
            container.innerHTML = '';
            const labels = { N: '情緒安定性', E: '外向性', O: '知的好奇心', A: '協調性', C: '勤勉性' };
            const colorMap = {
                'text-red-500': '#ef4444', 'text-orange-500': '#f97316', 'text-yellow-500': '#eab308',
                'text-yellow-600': '#ca8a04', 'text-brown-500': '#a16207', 'text-green-500': '#22c55e',
                'text-gray-500': '#6b7280', 'text-blue-300': '#93c5fd', 'text-purple-600': '#9333ea',
                'text-blue-700': '#1d4ed8', 'text-gray-700': '#374151', 'text-indigo-500': '#6366f1'
            };
            let barColor = colorMap[colorClass] || '#7189bf';

            for (const [key, value] of Object.entries(stats)) {
                const widthPercent = Math.abs(value); 
                const directionStyle = value >= 0 
                    ? `left: 50%; width: ${widthPercent}%; border-radius: 0 4px 4px 0;` 
                    : `right: 50%; width: ${widthPercent}%; border-radius: 4px 0 0 4px;`;
                
                const html = `
                    <div class="bigfive-row">
                        <div class="bigfive-label">${labels[key]}</div>
                        <div class="bigfive-bar-container">
                            <div class="bigfive-center-line"></div>
                            <div class="bigfive-bar" style="${directionStyle} background-color: ${barColor};"></div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            }
        }

        function openModal(id) {
            const char = characters.find(c => c.id === id);
            if(!char) return;

            // Robust Image Fallback logic for Modal Main Icon
            const modalIconContainer = document.getElementById('modal-icon-container');
            modalIconContainer.innerHTML = `
                <div class="relative w-full h-full flex justify-center items-center">
                    <img src="${char.image}" alt="${char.name}" 
                        class="w-32 h-32 object-cover rounded-full border-4 border-white shadow-md mx-auto absolute inset-0 z-10"
                        onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';"
                    >
                    <i class="fa-solid ${char.icon} text-7xl drop-shadow-sm inline-block ${char.color} hidden mt-4"></i>
                </div>
            `;

            document.getElementById('modal-name').innerText = char.name;
            document.getElementById('modal-role').innerText = char.role;
            document.getElementById('modal-catch').innerText = char.catchphrase;
            document.getElementById('modal-past').innerText = char.past;
            document.getElementById('modal-policy').innerText = char.policy;
            document.getElementById('modal-motivation').innerText = char.motivation;
            document.getElementById('modal-vibe').innerText = char.vibe;

            renderBigFiveChart(char.stats, char.color);

            const buddyContainer = document.getElementById('modal-buddies-container');
            buddyContainer.innerHTML = '';
            
            char.buddies.forEach(b => {
                const partner = characters.find(c => c.id === b.id);
                const div = document.createElement('div');
                div.className = "flex items-start gap-4 p-4 bg-blue-50/50 rounded-xl cursor-pointer hover:bg-blue-50 transition border border-blue-50 items-center";
                div.onclick = () => openModal(partner.id);
                
                // Robust Image Fallback for Buddy Icons
                const buddyIconHtml = `
                    <div class="relative w-12 h-12 flex-shrink-0 flex justify-center items-center">
                         <img src="${partner.image}" 
                            class="w-12 h-12 object-cover rounded-full border border-white absolute inset-0 z-10"
                            onerror="this.style.display='none'; this.nextElementSibling.style.display='block';"
                         >
                         <div class="text-2xl pt-1 ${partner.color} hidden"><i class="fa-solid ${partner.icon}"></i></div>
                    </div>
                `;

                div.innerHTML = `
                    ${buddyIconHtml}
                    <div>
                        <h5 class="font-bold text-gray-800 text-sm mb-1">vs ${partner.name} <span class="text-xs font-normal text-gray-400">(${partner.role})</span></h5>
                        <p class="text-gray-600 text-xs leading-relaxed">${b.desc}</p>
                    </div>
                `;
                buddyContainer.appendChild(div);
            });

            document.getElementById('char-modal').classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('char-modal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        function filterCharacters(type) {
            renderGrid(type);
        }

        function scrollToId(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        window.addEventListener('load', () => {
            renderGrid();
        });
    </script>
</body>
</html>
